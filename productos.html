<!-- Página de productos de Ferreriwork -->
<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Metadatos y enlaces de estilos -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos | Ferreriwork</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header con logo y navegación principal -->
    <header class="header">
        <div class="container">
            <div class="logo-header">
                <img src="logo ferreri.jpg" alt="Logo Ferreriwork" class="logo-img" />
                <h1 class="logo">Ferreri-<span>work</span></h1>
            </div>
            <nav class="nav">
                <a href="index.html">Inicio</a>
                <a href="productos.html">Productos</a>
                <a href="ofertas.html">Ofertas</a>
                <a href="Mas.html">Mas</a>
            </nav>
        </div>
    </header>
    <!-- Contenido principal -->
    <main class="main">
        <!-- Sección de productos -->
        <section class="productos">
            <div class="container">
                <!-- Título de la sección -->
                <h3 style="color:#ff6600; font-size:2.3em; text-align:center; font-weight:bold; letter-spacing:1px; text-shadow:0 2px 12px #8882, 0 1px 0 #fff; margin-bottom:1.2em; border-bottom:2px solid #ff6600; padding-bottom:0.3em;">Nuestros Productos</h3>
                
                <!-- Filtros de búsqueda por nombre y marca en un solo formulario -->
                <form id="busqueda-productos" class="form-busqueda" onsubmit="return false;">
                    <span class="input-lupa">
                        <svg class="icon-lupa" viewBox="0 0 24 24"><circle cx="11" cy="11" r="7" stroke="#ff6600" stroke-width="2" fill="none"/><line x1="16.5" y1="16.5" x2="21" y2="21" stroke="#ff6600" stroke-width="2" stroke-linecap="round"/></svg>
                        <input type="text" id="buscar-nombre" placeholder="Buscar por nombre..." />
                    </span>
                    <span class="select-marca">
                        <svg class="icon-marca" viewBox="0 0 24 24"><path d="M3 7v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2h-4.18C14.4 4.84 13.3 4 12 4s-2.4.84-2.82 1H5c-1.1 0-2 .9-2 2zm2 0h14v10H5V7zm7-1c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z" fill="#ff6600"/></svg>
                        <select id="buscar-marca-select">
                            <option value="">Todas las marcas</option>
                            <option value="Sata">Sata</option>
                            <option value="Stanley">Stanley</option>
                            <option value="Truper">Truper</option>
                            <option value="Ferreriwork">Ferreriwork</option>
                            <option value="Pretul">Pretul</option>
                            <option value="Toptul">Toptul</option>
                            <option value="Ferrawyy">Ferrawyy</option>
                            <option value="Tolsen">Tolsen</option>
                        </select>
                    </span>
                </form>
                <!-- Botón para ver cotización -->
                <div style="display: flex; justify-content: flex-end; margin-bottom: 1.5rem;">
                    <div style="display: flex; flex-direction: column; align-items: flex-end; width: 100%;">
                        <button id="btn-ver-cotizacion" class="btn-cotizacion" style="display: flex; align-items: center; gap: 0.5rem; background: #ff6600; color: #fff; border: none; border-radius: 4px; padding: 0.7em 1.5em; font-weight: bold; cursor: pointer; box-shadow: 0 2px 8px #0001;">
                            <svg width="20" height="20" fill="none" viewBox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.83A2 2 0 0 0 19.41 7.4l-4.83-4.83A2 2 0 0 0 13.17 2H6zm6 1.5V8a1 1 0 0 0 1 1h4.5L12 3.5zM6 4h6v5a3 3 0 0 0 3 3h5v10a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4zm6 13v-2h2v2h-2zm-4 0v-2h2v2H8zm0-4v-2h2v2H8zm4 0v-2h2v2h-2z" fill="#fff"/></svg>
                            Ver Cotización
                        </button>
                        <!-- Botón WhatsApp para enviar cotización -->
                        <a href="https://wa.me/51946149128?text=Hola%20Ferreriwork,%20quiero%20enviar%20mi%20cotización" target="_blank" class="btn-principal btn-icono btn-hero" style="margin-top:1em; background:#25d366; color:#fff; display:inline-flex; align-items:center; gap:0.5em; font-weight:bold;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.198.297-.767.967-.94 1.166-.173.198-.347.223-.644.075-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.447-.52.149-.174.198-.298.298-.497.099-.198.05-.372-.025-.521-.075-.149-.669-1.611-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.372-.01-.571-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.099 3.2 5.076 4.363.71.306 1.263.489 1.695.625.712.227 1.36.195 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z" fill="#fff"/></svg>
                            Enviar cotización
                        </a>
                    </div>
                </div>
                <!-- poner productos -->
                    <div class="productos-grid" id="productos-lista">

                    <div class="producto-card" data-nombre="Gata hidráulica 2 toneladas" data-marca="Truper">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://media.falabella.com/falabellaPE/117539116_01/w=800,h=800,fit=pad" alt="Gata hidráulica 2 toneladas" />
                        <h4>Gata hidráulica 2 toneladas</h4>
                        <p>Gata hidráulica 2 toneladas</p>
                        <span class="precio">S/ 150</span>
                        <span class="marca">Marca: Truper</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>
                    
                    <div class="producto-card" data-nombre="Maleta de herramientas 216 piezas" data-marca="Tolsen">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://sc04.alicdn.com/kf/Hb915614dfe38417197d57e568494a7c8n.jpg" alt="Maleta de herramientas 216 piezas" />
                        <h4>Maleta de herramientas 216 piezas</h4>
                        <p>Maleta de herramientas 216 piezas encaste de 1/2, 3/8 y 1/4</p>
                        <span class="precio">S/ 540</span>
                        <span class="marca">Marca: Tolsen</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>

                    <div class="producto-card" data-nombre="Juego de llaves 14 piezas" data-marca="Ferrawyy">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://http2.mlstatic.com/D_NQ_NP_833502-MPE71803575431_092023-O-set-14-llaves-mixta-acero-satinado-6-24mm-ferrawy-no-stanley.webp" alt="Juego de llaves 14 piezas" />
                        <h4>Juego de llaves 14 piezas</h4>
                        <p>Juego de llaves 14 piezas : 6-24</p>
                        <span class="precio">S/ 75</span>
                        <span class="marca">Marca: Ferrawyy</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>

                    <div class="producto-card" data-nombre="Maleta de herramientas 216 piezas" data-marca="Ferreriwork">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="maleta ferrerix216.jpg" alt="Maleta de herramientas 216 piezas" />
                        <h4>Maleta de herramientas 216 piezas</h4>
                        <p>Maleta de herramientas 216 piezas encaste de 1/2, 3/8 y 1/4</p>
                        <span class="precio">S/ 460</span>
                        <span class="marca">Marca: Ferreriwork</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>

                    <div class="producto-card" data-nombre="Juego de Dados 46 piezas" data-marca="Sata">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://bulplus.net/wp-content/uploads/2023/05/SATA-46.jpg-2.jpg" alt="Juego de dados 46 piezas" />
                        <h4>Juego de Dados 46 piezas</h4>
                        <p>Juego de dados encaste de 1/2 x 46 piezas</p>
                        <span class="precio">S/ 360</span>
                        <span class="marca">Marca: Sata</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>    

                    <div class="producto-card" data-nombre="Torquimetro Digital" data-marca="Toptul">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://http2.mlstatic.com/D_NQ_NP_709959-MPE48446541481_122021-O.webp" alt="Torquimetro Digital" />
                        <h4>Torquimetro Digital</h4>
                        <p>Torquimetro digital 1/2x40-200NM.</p>
                        <span class="precio">S/ 250</span>
                        <span class="marca">Marca: Toptul</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>    

                    <div class="producto-card" data-nombre="Juego de herramientas 1/4" data-marca="Pretul">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://cahema.pe/82356-large_default/juego-de-herramientas-14-22-piezas-pretul-23980.jpg" alt="Juego de herramientas 1/4" />
                        <h4>Juego de herramientas 1/4</h4>
                        <p>22 piezas encaste de 1/4.</p>
                        <span class="precio">S/ 70</span>
                        <span class="marca">Marca: Pretul</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>
                    <div class="producto-card" data-nombre="Torre para auto 3 toneladas Truper" data-marca="Truper">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://promart.vteximg.com.br/arquivos/ids/7980639-1000-1000/1681495203850-1.png?v=638515591562400000" alt="Torre para auto truper 3 toneladas" />
                        <h4>Torre para auto 3 toneladas</h4>
                        <p>Torre para auto 3 toneladas.</p>
                        <span class="precio">S/ 130</span>
                        <span class="marca">Marca: Truper</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>
                    <div class="producto-card" data-nombre="Juego de llaves Stanley" data-marca="Stanley">
                        <input type="number" class="cantidad-cotizar" min="0" value="0" style="display:none;" title="Cantidad a cotizar" />
                        <img src="https://www.ferropolis.pe/cdn/shop/products/85-783-1.webp?v=1663256988" alt="Juego de llaves Stanley" />
                        <h4>Juego de llaves 20 piezas </h4>
                        <p>Llaves milimétricas y en pulgadas.</p>
                        <span class="precio">S/ 130</span>
                        <span class="marca">Marca: Stanley</span>
                        <button class="btn-comprar" type="button">Cotizar</button>
                    </div>
                
        </section>
        <!-- Modal de cotización -->
        <div id="modal-cotizacion" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0008; z-index:1000; align-items:center; justify-content:center;">
            <div style="background:#fff; border-radius:10px; max-width:95vw; width:400px; padding:2em 1.5em; box-shadow:0 4px 24px #0003; position:relative;">
                <button id="cerrar-modal-cotizacion" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:1.5em; color:#ff6600; cursor:pointer;">&times;</button>
                <h3 style="color:#ff6600; text-align:center; margin-bottom:1em;">Cotización seleccionada</h3>
                <div id="cotizacion-lista"></div>
                <form id="form-datos-cliente" style="margin-top:1.5em; margin-bottom:0.5em; display:flex; flex-direction:column; gap:0.7em; align-items:center;">
                    <input id="nombre-cliente" type="text" placeholder="Nombre completo" style="width:90%; padding:0.5em; border-radius:4px; border:1px solid #ccc; font-size:1em;" required />
                    <input id="dni-cliente" type="text" placeholder="DNI" maxlength="12" style="width:90%; padding:0.5em; border-radius:4px; border:1px solid #ccc; font-size:1em;" required />
                </form>
                <div style="display:flex; gap:1em; justify-content:center; margin-top:0.5em;">
                    <button id="btn-vaciar-cotizacion" style="background:#eee; color:#ff6600; border:none; border-radius:4px; padding:0.6em 1.2em; font-weight:bold; cursor:pointer;">Vaciar cotización</button>
                    <button id="btn-descargar-pdf" style="background:#ff6600; color:#fff; border:none; border-radius:4px; padding:0.6em 1.2em; font-weight:bold; cursor:pointer;">Descargar PDF</button>
                </div>
            </div>
        </div>
        <script>
        // Filtrado de productos por nombre y marca
        const inputNombre = document.getElementById('buscar-nombre');
        const selectMarca = document.getElementById('buscar-marca-select');
        const productos = document.querySelectorAll('.producto-card');

        function filtrarProductos() {
            const nombre = inputNombre.value.toLowerCase();
            const marca = selectMarca.value;
            productos.forEach(card => {
                const nombreProd = card.getAttribute('data-nombre').toLowerCase();
                const marcaProd = card.getAttribute('data-marca');
                const coincideNombre = nombreProd.includes(nombre);
                const coincideMarca = !marca || marcaProd === marca;
                if (coincideNombre && coincideMarca) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        }
        inputNombre.addEventListener('input', filtrarProductos);
        selectMarca.addEventListener('change', filtrarProductos);

        // Mostrar cotización seleccionada
        document.getElementById('btn-ver-cotizacion').addEventListener('click', function() {
            const modal = document.getElementById('modal-cotizacion');
            const lista = document.getElementById('cotizacion-lista');
            // Obtener productos con cantidad > 0 y visibles
            const seleccionados = Array.from(document.querySelectorAll('.producto-card')).filter(card => {
                const cantidad = parseInt(card.querySelector('.cantidad-cotizar').value, 10);
                return cantidad > 0 && card.style.display !== 'none';
            });
            if (seleccionados.length === 0) {
                lista.innerHTML = '<p style="color:#c00; text-align:center;">No hay productos seleccionados para cotizar.</p>';
            } else {
                let html = '<table style="width:100%; border-collapse:collapse;">';
                html += '<tr style="background:#ff6600; color:#fff;"><th style="padding:6px;">Producto</th><th style="padding:6px;">Marca</th><th style="padding:6px;">Cantidad</th><th style="padding:6px;">Precio Unitario</th><th style="padding:6px;">Subtotal</th></tr>';
                let total = 0;
                seleccionados.forEach(card => {
                    const nombre = card.querySelector('h4').textContent;
                    const marca = card.querySelector('.marca').textContent.replace('Marca: ','');
                    const precio = parseFloat(card.querySelector('.precio').textContent.replace('S/','').replace(',','.'));
                    const cantidad = parseInt(card.querySelector('.cantidad-cotizar').value, 10);
                    const subtotal = precio * cantidad;
                    total += subtotal;
                    html += `<tr><td style="padding:6px; border-bottom:1px solid #eee;">${nombre}</td><td style="padding:6px; border-bottom:1px solid #eee;">${marca}</td><td style="padding:6px; border-bottom:1px solid #eee; text-align:center;"><input type='number' min='1' value='${cantidad}' data-nombre='${nombre}' class='modal-cantidad' style='width:45px; text-align:center; border-radius:4px; border:1px solid #ccc;'/></td><td style="padding:6px; border-bottom:1px solid #eee;">S/ ${precio.toFixed(2)}</td><td style="padding:6px; border-bottom:1px solid #eee;">S/ ${subtotal.toFixed(2)}</td></tr>`;
                });
                html += `<tr style="font-weight:bold;"><td colspan="4" style="text-align:right; padding:8px;">Total:</td><td style="padding:8px; color:#ff6600;">S/ ${total.toFixed(2)}</td></tr>`;
                html += '</table>';
                lista.innerHTML = html;
                // Evento para actualizar cantidad desde el modal
                lista.querySelectorAll('.modal-cantidad').forEach(input => {
                    input.addEventListener('change', function(e) {
                        let nuevaCantidad = parseInt(e.target.value, 10);
                        if (isNaN(nuevaCantidad) || nuevaCantidad < 1) nuevaCantidad = 1;
                        e.target.value = nuevaCantidad;
                        // Buscar la tarjeta y actualizar el input oculto
                        const nombreProd = e.target.getAttribute('data-nombre');
                        document.querySelectorAll('.producto-card').forEach(card => {
                            if (card.querySelector('h4').textContent === nombreProd) {
                                card.querySelector('.cantidad-cotizar').value = nuevaCantidad;
                            }
                        });
                        // Volver a mostrar el modal actualizado
                        document.getElementById('btn-ver-cotizacion').click();
                    });
                });
            }
            modal.style.display = 'flex';
        });
        document.getElementById('cerrar-modal-cotizacion').addEventListener('click', function() {
            document.getElementById('modal-cotizacion').style.display = 'none';
        });

        // Vaciar cotización
        document.getElementById('btn-vaciar-cotizacion').addEventListener('click', function() {
            document.querySelectorAll('.cantidad-cotizar').forEach(input => { input.value = 0; });
            document.getElementById('modal-cotizacion').style.display = 'none';
        });

        // Descargar PDF de la cotización (diseño profesional y datos cliente requeridos)
        document.getElementById('btn-descargar-pdf').addEventListener('click', function() {
            const nombre = document.getElementById('nombre-cliente').value.trim();
            const dni = document.getElementById('dni-cliente').value.trim();
            if (!nombre || !dni) {
                alert('Por favor, ingresa tu nombre y DNI para descargar la cotización.');
                document.getElementById('nombre-cliente').focus();
                return;
            }
            if (!window.jspdf) {
                alert('No se puede descargar el PDF. Intenta recargar la página.');
                return;
            }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            // Logo Ferreriwork (SVG base64)
            const logoFerreri = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD...'; // Puedes reemplazar por tu logo real en base64
            // Encabezado con logo y título
            doc.setFillColor(255,102,0);
            doc.rect(0, 0, 210, 30, 'F');
            if (logoFerreri.length > 30) {
                doc.addImage(logoFerreri, 'JPEG', 12, 6, 18, 18);
            }
            doc.setFontSize(20);
            doc.setTextColor(255,255,255);
            doc.text('Cotización Ferreriwork', 105, 20, { align: 'center' });
            doc.setFontSize(12);
            doc.setTextColor(80,80,80);
            doc.text('Fecha: ' + new Date().toLocaleDateString(), 14, 36);
            doc.text('Cliente: ' + nombre, 14, 43);
            doc.text('DNI: ' + dni, 120, 43);
            doc.setDrawColor(255,102,0);
            doc.line(14, 47, 196, 47);
            let y = 55;
            // Tabla de productos con fondo alterno y bordes
            doc.setFontSize(13);
            doc.setTextColor(255,102,0);
            doc.setFillColor(255,102,0);
            doc.rect(14, y-6, 182, 10, 'F');
            doc.setTextColor(255,255,255);
            doc.text('Producto', 18, y);
            doc.text('Marca', 80, y);
            doc.text('Cantidad', 115, y);
            doc.text('Unitario', 145, y);
            doc.text('Subtotal', 175, y);
            y += 8;
            doc.setLineWidth(0.2);
            doc.setDrawColor(200,200,200);
            let total = 0;
            const seleccionados = Array.from(document.querySelectorAll('.producto-card')).filter(card => {
                const cantidad = parseInt(card.querySelector('.cantidad-cotizar').value, 10);
                return cantidad > 0 && card.style.display !== 'none';
            });
            if (seleccionados.length === 0) {
                doc.setTextColor(200,0,0);
                doc.text('No hay productos seleccionados para cotizar.', 18, y);
            } else {
                seleccionados.forEach((card, idx) => {
                    const nombreProd = card.querySelector('h4').textContent;
                    const marca = card.querySelector('.marca').textContent.replace('Marca: ','');
                    const precio = parseFloat(card.querySelector('.precio').textContent.replace('S/','').replace(',','.'));
                    const cantidad = parseInt(card.querySelector('.cantidad-cotizar').value, 10);
                    const subtotal = precio * cantidad;
                    total += subtotal;
                    // Fondo alterno
                    if (idx % 2 === 0) {
                        doc.setFillColor(245,245,245);
                        doc.rect(14, y-6, 182, 10, 'F');
                    }
                    doc.setFontSize(12);
                    doc.setTextColor(0,0,0);
                    doc.text(nombreProd, 18, y, { maxWidth: 60 });
                    doc.text(marca, 80, y);
                    doc.text(String(cantidad), 115, y, { align: 'center' });
                    doc.text('S/ ' + precio.toFixed(2), 145, y);
                    doc.text('S/ ' + subtotal.toFixed(2), 175, y);
                    doc.line(14, y+2, 196, y+2);
                    y += 10;
                    if (y > 250) {
                        doc.addPage();
                        y = 20;
                    }
                });
                doc.setFontSize(14);
                doc.setTextColor(255,102,0);
                doc.text('Total: S/ ' + total.toFixed(2), 105, y+8, { align: 'center' });
            }
            // Pie de página
            doc.setFontSize(10);
            doc.setTextColor(120,120,120);
            doc.text('Ferreriwork | www.ferreriwork.com', 105, 285, { align: 'center' });
            doc.save('cotizacion-ferreriwork.pdf');
        });
        // Cargar jsPDF si no está presente
        if (!window.jspdf) {
            var script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            document.head.appendChild(script);
        }

        // Hacer que el botón "Cotizar" aumente la cantidad del producto
        document.querySelectorAll('.btn-comprar').forEach(btn => {
            btn.addEventListener('click', function(e) {
                const card = e.target.closest('.producto-card');
                const cantidadInput = card.querySelector('.cantidad-cotizar');
                cantidadInput.value = parseInt(cantidadInput.value, 10) + 1;
                // Efecto visual breve
                card.style.boxShadow = '0 0 0 3px #ff6600aa';
                setTimeout(() => { card.style.boxShadow = ''; }, 400);
            });
        });

        // Hacer que el botón "Cotizar" seleccione el producto
        document.querySelectorAll('.btn-comprar').forEach(btn => {
            btn.addEventListener('click', function(e) {
                const card = e.target.closest('.producto-card');
                const check = card.querySelector('.check-cotizar');
                check.checked = true;
                // Efecto visual breve
                card.style.boxShadow = '0 0 0 3px #ff6600aa';
                setTimeout(() => { card.style.boxShadow = ''; }, 400);
            });
        });
        </script>
    </main>
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Ferreriwork. Todos los derechos reservados.</p>
            <p style="font-size:0.98em; color:#888; margin-top:0.3em;">
                Dirección: <a href="https://maps.app.goo.gl/ESuVUjNBkGiccMqf7" target="_blank" style="color:#ff6600; text-decoration:underline;">Jron. Saéns Peña 110</a>
        </div>
    </footer>
</body>
</html>


