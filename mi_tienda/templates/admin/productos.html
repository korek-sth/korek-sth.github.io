{% extends "base.html" %}
{% block content %}
<style>
.admin-header {
  background: linear-gradient(135deg, #ff8c42 0%, #ff9f5a 100%);
  color: white;
  padding: 30px;
  border-radius: 8px;
  margin-bottom: 30px;
}

.admin-header h2 {
  margin: 0 0 15px 0;
  font-size: 28px;
}

.admin-acciones {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-bottom: 30px;
}

.btn-admin {
  padding: 10px 18px;
  border: none;
  border-radius: 6px;
  text-decoration: none;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-block;
}

.btn-back {
  background: #6b7280;
  color: white;
}

.btn-back:hover {
  background: #4b5563;
}

.btn-add {
  background: #10b981;
  color: white;
}

.btn-add:hover {
  background: #059669;
}

.btn-logout {
  background: #ef4444;
  color: white;
}

.btn-logout:hover {
  background: #dc2626;
}

.tabla-container {
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
}

.tabla-container table {
  width: 100%;
  border-collapse: collapse;
}

.tabla-container thead {
  background: #6b7280;
  color: white;
}

.tabla-container th {
  padding: 14px;
  text-align: left;
  font-weight: 600;
  font-size: 13px;
  text-transform: uppercase;
}

.tabla-container td {
  padding: 14px;
  border-bottom: 1px solid #e6e9ef;
}

.tabla-container tbody tr:hover {
  background: #f9f5f0;
}

.tabla-container tbody tr:last-child td {
  border-bottom: none;
}

.producto-img {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: 6px;
  background: #f0f0f0;
}

.producto-nombre {
  font-weight: 600;
  color: #222;
}

.producto-marca {
  color: #6b7280;
  font-size: 12px;
}

.producto-precio {
  color: #ff8c42;
  font-weight: 700;
  font-size: 15px;
}

.acciones {
  display: flex;
  gap: 8px;
}

.btn-editar {
  padding: 6px 12px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  text-decoration: none;
  display: inline-block;
  transition: background 0.2s;
}

.btn-editar:hover {
  background: #2563eb;
}

.btn-eliminar {
  padding: 6px 12px;
  background: #ef4444;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.2s;
}

.btn-eliminar:hover {
  background: #dc2626;
}

.sin-productos {
  text-align: center;
  padding: 40px;
  color: #6b7280;
  font-size: 16px;
}

@media (max-width: 700px) {
  .admin-acciones { flex-direction: column; }
  .btn-admin { width: 100%; }
  .tabla-container { overflow-x: auto; }
}
</style>

<div class="admin-header">
  <h2>üì¶ Administraci√≥n de Productos</h2>
  <p style="margin: 0; opacity: 0.95;">Gestiona el cat√°logo de productos de tu tienda</p>
</div>

<div class="admin-acciones">
  <a href="{{ url_for('admin_index') }}" class="btn-admin btn-back">‚Üê Volver al Dashboard</a>
  <a href="{{ url_for('add_producto') }}" class="btn-admin btn-add">‚ûï Agregar Nuevo Producto</a>
  <a href="{{ url_for('admin_logout') }}" class="btn-admin btn-logout">üö™ Cerrar Sesi√≥n</a>
</div>

{% if productos %}
<div class="tabla-container">
  <table>
    <thead>
      <tr>
        <th style="width: 80px;">ID</th>
        <th style="width: 100px;">Imagen</th>
        <th>Nombre</th>
        <th style="width: 100px;">Marca</th>
        <th style="width: 90px;">Precio</th>
        <th style="width: 150px;">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for producto in productos %}
      <tr>
        <td><strong>#{{ producto.id }}</strong></td>
        <td><img src="{{ producto.imagen }}" alt="{{ producto.nombre }}" class="producto-img"></td>
        <td>
          <div class="producto-nombre">{{ producto.nombre }}</div>
          {% if producto.get('marca') %}<div class="producto-marca">{{ producto.marca }}</div>{% endif %}
        </td>
        <td>{{ producto.get('marca', '-') }}</td>
        <td><span class="producto-precio">S/ {{ "%.2f"|format(producto.precio) }}</span></td>
        <td>
          <div class="acciones">
            <a href="{{ url_for('edit_producto', id=producto.id) }}" class="btn-editar">‚úèÔ∏è Editar</a>
            <button onclick="eliminarProducto({{ producto.id }})" class="btn-eliminar">üóëÔ∏è Eliminar</button>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="tabla-container">
  <div class="sin-productos">
    <p>üì≠ No hay productos registrados a√∫n</p>
    <a href="{{ url_for('add_producto') }}" class="btn-admin btn-add">Crear el primer producto</a>
  </div>
</div>
{% endif %}

<script>
function eliminarProducto(id) {
  if (confirm('¬øEst√°s seguro de que deseas eliminar este producto?')) {
    fetch(`/admin/eliminar/${id}`, { method: 'POST' })
      .then(res => {
        if (res.ok) {
          alert('Producto eliminado exitosamente');
          location.reload();
        } else {
          alert('Error al eliminar el producto');
        }
      })
      .catch(err => alert('Error: ' + err));
  }
}
</script>
{% endblock %}
